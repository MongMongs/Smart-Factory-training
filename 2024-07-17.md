## 

11g Express = > SQL 메모리 1G로 제한됨
11g = > 파일 중심 처리
19ㅊ => RDB, NoSQL

서버(Server) =>  Daemon, 서비스(백그라운드로 동작) (oracle Service XE 가 서버임)
클라이언트 => SQL Developer(우리가 사용중, 윈도우용, 자바기반이라 설치가 따로 필요없음, 경로로 실행, 폴더 날리면 지워짐) , SQL Plus(콘솔용) =>TCPIP로 서버에 데이터를 보냄

1. 계정 설정
처음 설치 시 비밀번호 설정 ==> system, sysdba 관리자
연습용 계정을 UNlock(hr) 하거나 만들었다(scott)
express에는 scott 계정이 없어서 만듦
-> scott 계정에 기타 권한을 부여했다.

  => 설치 위치 c:\oracle\app\oracle\product\sever
  -> scott 계정 만들 때 사용한 쿼리 scott.sql (oraclexe에서 찾으면 나옴)
   
3. 연습용 계정 scott으로 함
3. 삽입(INSERT), 삭제(DELETE), 수정(UPDATE), 검색
4. 정렬 ORDER BY
5. 조건 WHERE
6. 특정 조건 제거 DISTINCT
iiot가 중요함 우리나라에서


--2024-07-17
--EMP 
SELECT * FROM EMP;
SELECT * FROM ENAME, JOB, DEPNO FROM EMP;

SELECT * FROM EMP
WHERE DEPTNO = 20 OR  DEPTNO = 10;

SELECT DNAME FROM DEPT ORDER BY DNAME DESC;

SELECT * FROM EMP WHERE SAL BETWEEN 1500 AND 3000;

SELECT ENAME "이름", SAL "월급" FROM EMP;

-- 직원중 CLERK. SALESMAN 이 아닌 데이터 출력
SELECT * FROM EMP WHERE JOB !='SALESMAN' AND JOB <> 'CLERK';
SELECT * FROM EMP WHERE JOB NOT IN ('SALESMAN', 'CLERK');

--111p

-- 이름이 S 로 시작하는 데이터 출력 아래 %S의 의미는 S로 시작하는 모든 데이터를 나타냄
SELECT * FROM EMP WHERE ENAME LIKE 'S%';
-- 이름에 S가 들어가는 모든 데이터 출력하는 코드
SELECT * FROM EMP WHERE ENAME LIKE '%S%';
-- 이름의 2번째 문자로 L 이 들어가는 모든 데이터 출력
SELECT * FROM EMP WHERE ENAME LIKE '_L%';
-- 이름의 2번째 이상 자리의 문자로 L 이 들어가는 모든 데이터 출력
SELECT * FROM EMP WHERE ENAME LIKE '%_L%';
-- 이름의 3번째 이상 자리의 문자로 L 이 들어가는 모든 데이터 출력
SELECT * FROM EMP WHERE ENAME LIKE '%__L%';
-- 이름에 AM가 들어가는 모든 데이터 출력하는 코드
SELECT * FROM EMP WHERE ENAME LIKE '%AM%';
-- 이름에 AM가 안 들어가는 모든 데이터 출력하는 코드
SELECT * FROM EMP WHERE ENAME NOT LIKE '%AM%';

-- Q COMM 이 NULL 값인 데이터만 출력하려면?
SELECT * FROM EMP WHERE COMM IS NULL;
-- Q COMM 이 NULL 값이 아닌 데이터만 출력하려면?
SELECT * FROM EMP WHERE COMM IS NOT NULL;
-- Q MGR 이 NULL 값인 데이터만 출력하려면?
SELECT * FROM EMP WHERE MGR IS NULL;

-- 실습 5-29 OR 연산자와 IS NULL 같이 사용
SELECT * FROM EMP WHERE SAL > NULL OR COMM IS NULL;

-- 오라ㅡㄹ 내장함수와 함께 사용
SELECT ENAME, UPPER(ENAME), LOWER(ENAME), INITCAP(ENAME) FROM EMP;

-- 이름 비교
SELECT * FROM EMP WHERE UPPER(ENAME) = UPPER('king');

-- 집합 연산자를 사용하여 출력하기(합집합)112P~
SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP
UNION
SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP WHERE DEPTNO = 10;
-- UNION으로 결합 할 때요소 수가 이상해지면 데이터 출력이 안된다.
-- UNION으로 결합했을 요소 갯수가 같을때 데이터가 합쳐지지만 순서 및 요소의 값이 이상해 진다.
SELECT SAL, DEPTNO, SAL FROM EMP WHERE DEPTNO = 20;
-- 차집합
SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP
MINUS
SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP WHERE DEPTNO = 10;

-- 교집합
SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP
INTERSECT
SELECT EMPNO, ENAME, SAL, DEPTNO FROM EMP WHERE DEPTNO = 10;

--125P
--Q1
SELECT * FROM EMP WHERE ENAME LIKE '%S';

--Q2
SELECT EMPNO, ENAME, JOB, SAL, DEPTNO FROM EMP WHERE DEPTNO = 30 AND JOB = 'SALESMAN';

--Q3
SELECT EMPNO, ENAME, JOB, SAL, DEPTNO FROM EMP WHERE DEPTNO = 20 OR DEPTNO = 30 AND JOB = 'SALESMAN';

--Q4
SELECT * FROM EMP WHERE SAL >=2000 AND SAL <= 3000;

--Q5
SELECT * FROM EMP WHERE ENAME LIKE '%E%' AND DEPTNO = 30 AND SAL <=1000 OR SAL >=2000;

--Q6 // IN 안쓰고 OR 쓰면 오류가 날 가능성 있으니 IN()사용해야함
SELECT * FROM EMP WHERE ENAME NOT LIKE '_L%' AND COMM IS NULL AND MGR IS NOT NULL AND JOB IN('MANAGER', 'CLERK');
-- P132 길이
SELECT ENAME, LENGTH(ENAME) AS 문자열길이, LENGTHB(ENAME) AS 문자크기 FROM EMP;
-- 테이블이 없을때 DUAL 사용해야함
SELECT ENAME, LENGTH('홍길동') AS 문자열길이, LENGTHB('홍길동') AS 문자크기 FROM DUAL;
-- 테이블에 없는 데이터를 계산 등 기능 구현을 할 때 DUAL 을 사용한다.
SELECT 12 + 5 FROM DUAL;


-- 응용
-- 문자열 추출 SUBSTRING 134p
-- > 0의 개념이 없음 1부터 시작함
SELECT JOB, SUBSTR(JOB,1,2),SUBSTR(JOB,2,1), SUBSTR(JOB,3,2),SUBSTR(JOB,5)FROM EMP;

-- 주민번호 조합
SELECT '991225-1234567',
SUBSTR('991225-1234567',1,2)출생년도,
SUBSTR('991225-1234567',3,4)생일,
SUBSTR('991225-1234567',8,1)성별
FROM DUAL;

-- 마이너스 표현
SELECT JOB,
SUBSTR(JOB, -LENGTH(JOB)),
SUBSTR(JOB, -LENGTH(JOB), 2),
SUBSTR(JOB, -3)
FROM EMP;

--INSTR 문자 위치를 찾는 함수(스패이스바 부분 포함)
SELECT INSTR('HELLP ORACLE!','L')FROM DUAL;
SELECT INSTR('HELLP ORACLE!','L', 2, 3)FROM DUAL;


SELECT INSTR('길동동동 길길 이이이 동 길 이길동','길',)FROM DUAL;
SELECT INSTR('길동동동 길길 이이이 동 길 이길동','길동',5,1)FROM DUAL;

-- 수정, 교환 REPLACE
SELECT '010-1234-5678',
REPLACE('010-1234-5678', '-', '*'),
REPLACE('010-1234-5678', '-', ''),
REPLACE('010-1234-5678', '-', ' '),
REPLACE('010-1234-5678', '-')
FROM DUAL;

--Q 주민번호 991225-1234567
--Q 생일 추출
--Q 13자리로 표현                        
--Q 앞자리 뒷자리 사이 공백으로 표현
SELECT '991225-1234567',
SUBSTR('991225-1234567',3,4),
REPLACE('991225-1234567','-'),
REPLACE('991225-1234567','-',' ')
FROM DUAL;

--140p
-- 데이터 빈 공간 특정 문자로 채우는 LPAD, RPAD 함수
-- 실습 6-13
SELECT 'ORACLE',
LPAD('ORACLE', 10,'#') AS LPAD_1,
RPAD('ORACLE', 10,'*') AS RPAD_1,
LPAD('ORACLE', 10) AS LPAD_2,
RPAD('ORACLE', 10) AS RPAD_2
FROM DUAL;

-- ROUND 반올림임
SELECT 31.41592, ROUND(31.41592,0),ROUND(31.51592,0), ROUND(31.41592,2),ROUND(31.41592,-1),ROUND(31.41592,-2)
FROM DUAL;

-- 버림 TRUNC
SELECT  TRUNC(1234.5678),TRUNC(1234.5678,1),TRUNC(1234.5678,2),TRUNC(1234.5678,-1),TRUNC(1234.5678,-2)FROM DUAL;

-- CEIL가장 가까운 큰 정수, FLOOR 가장 가까운 작은정수 
SELECT CEIL(3.14), FLOOR(3.14),CEIL(-3.14), FLOOR(-3.14)
FROM DUAL;
-- 나머지 MOD
SELECT MOD (15,6) FROM DUAL;

-- 날짜
SELECT SYSDATE,
SYSDATE-1 AS "어제",
SYSDATE +1 AS " 내일"
FROM DUAL;
--이후 
--몇개월 후 날짜
SELECT SYSDATE, ADD_MONTHS(SYSDATE, 3)
FROM DUAL;
-- 입사 10주년
SELECT SYSDATE, ADD_MONTHS(SYSDATE, 120)
FROM DUAL;

-- 입사 32년 미만인 사원
SELECT EMPNO, ENAME, HIREDATE, SYSDATE FROM EMP WHERE ADD_MONTHS(HIREDATE, 12)<SYSDATE;

-- 마지막 날짜
SELECT SYSDATE, NEXT_DAY(SYSDATE,'월요일'), LAST_DAY(SYSDATE), LAST_DAY(TO_DATE('24/02/10')) FROM DUAL;
-- 첫날을 구하는 코드
SELECT TRUNC(TO_DATE('24/09/13', 'YY/MM/DD'), 'MM') FROM DUAL;
-- 9월의 2번째 목요일 출력
SELECT NEXT_DAY(TO_DATE('24/09/01'), '목요일')+7 FROM DUAL;
SELECT NEXT_DAY(NEXT_DAY(TO_DATE('24/09/01'), '목요일'),'목요일') FROM DUAL;
SELECT NEXT_DAY(TRUNC(TO_DATE('24/09/13', 'YY/MM/DD'), 'MM')+6, '목요일') AS "두번째 목요일" FROM DUAL;

-- 실습 6-29ROUND 날짜 함수를 사용해 데이터 출력
SELECT SYSDATE, ROUND(SYSDATE,'CC'), ROUND(SYSDATE,'YYYY'), ROUND(SYSDATE,'Q'), ROUND(SYSDATE,'DDD') FROM DUAL;

--ORACLE DATA TYPE
-- EMP의 데이터 정보를 보는 코드
DESC EMP;

SELECT EMPNO, ENAME, EMPNO + '500'
FROM EMP;
-- 문자열+ 숫자 오류남 
SELECT 'ABCD' + EMPNO FROM EMP;


SELECT SYSDATE, 
TO_CHAR(SYSDATE), 
TO_CHAR(SYSDATE,'YYYY/MM/DD HH24:MI:SS'), 
TO_CHAR(SYSDATE, 'MM') AS "MM", 
TO_CHAR(SYSDATE,'MON') AS "MON", 
TO_CHAR(SYSDATE,'MONTH') AS "MONTH",
TO_CHAR(SYSDATE,'DD')AS "DD", 
TO_CHAR(SYSDATE,'DY') AS "DY", 
TO_CHAR(SYSDATE,'DAY') AS "DAY", 
TO_CHAR(SYSDATE,'MON', 'NLS_DATE_LANGUAGE = JAPANESE') AS "JPN",
TO_CHAR(SYSDATE,'MON', 'NLS_DATE_LANGUAGE = ENGLISH') AS "ENG"
FROM EMP;

-- TO CHAR 을 이용한 통화형식 지정
SELECT SAL,
TO_CHAR(SAL,'$999,999') AS "달러",
TO_CHAR(SAL,'L999,999') AS "원화",
TO_CHAR(SAL,'$999,999.00'),
TO_CHAR(SAL, '0999999.99')
FROM EMP;

-- 문자 데이터 처리
SELECT 1300 - '1500' FROM DUAL;

-- SELECT '1,300' - '1.500' FROM DUAL; -- ERROR
SELECT TO_NUMBER('1,300', '999,999') - TO_NUMBER('1,500', '999,999') FROM DUAL;

-- TO DATE
SELECT TO_DATE('2018-07-04','YYYY-MM-DD'), TO_DATE('2018-07-04','RR-MM-DD')FROM DUAL;

SELECT EMPNO, ENAME, SAL, COMM, SAL+COMM,
NVL(COMM,0),
SAL +NVL(COMM,0)
FROM EMP;

SELECT COMM, NVL(COMM,500) FROM EMP;
--NVL2
SELECT ENAME, COMM, NVL2(COMM, 'O', 'X')
FROM EMP;

SELECT ENAME, COMM, NVL2(COMM, 10, 0)
FROM EMP;

-- Q1
SELECT EMPNO, 
RPAD(SUBSTR(EMPNO , 1,2), 4,'*')AS "MASKING_EMPNO",
ENAME,
RPAD(SUBSTR(EMPNO , 1,2), 5,'*')AS "MASKING_ENAME"
FROM EMP;

--Q2
SELECT EMPNO, ENAME, SAL, TO_CHAR(SAL/21.5,'999,999.00') AS "DAY_PAY", TO_CHAR((SAL/21.5)/8,'999,999.00') AS "TIME_PAY"FROM EMP;

--Q3
SELECT EMPNO, ENAME, TO_CHAR(HIREDATE,'YYYY-MM-DD') AS "HIREDATE" , TO_CHAR(NEXT_DAY(TO_DATE(ADD_MONTHS(HIREDATE,3)),'월요일'),'YYYY-MM-DD') AS "R_JOB", NVL2(COMM,TO_CHAR(COMM),'N/A')AS "COMM" FROM EMP;

--Q4
SELECT EMPNO, ENAME, MGR,
    CASE
        WHEN MGR IS NULL THEN 0000
        WHEN SUBSTR(MGR,1,2) = 75 THEN 5555
        WHEN SUBSTR(MGR,1,2) = 76 THEN 6666
        WHEN SUBSTR(MGR,1,2) = 77 THEN 7777
        WHEN SUBSTR(MGR,1,2) = 78 THEN 8888
        ELSE MGR
    END AS CHG_MGR
FROM EMP;

SELECT EMPNO, ENAME,MGR, NVL(TO_CHAR(RPAD(SUBSTR(MGR,2,1),4,SUBSTR(MGR,2,1))), '0000') AS "CHG_MGR" FROM EMP;
